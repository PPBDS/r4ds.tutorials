---
title: Using AI With R
author: Luke Li
tutorial:
  id: ai-tutorial-test
output:
  learnr::tutorial:
    progressive: yes
    allow_skip: yes
runtime: shiny_prerendered
description: 'Tutorial for R for Data Science Integrated with AI (test)'
---

```{r setup, include = FALSE}
library(learnr)
library(tutorial.helpers)
library(tidyverse)

knitr::opts_chunk$set(echo = FALSE)
options(tutorial.exercise.timelimit = 600, 
        tutorial.storage = "local") 
```

```{r copy-code-chunk, child = system.file("child_documents/copy_button.Rmd", package = "tutorial.helpers")}
```

```{r info-section, child = system.file("child_documents/info_section.Rmd", package = "tutorial.helpers")}
```

## Introduction
### 

This tutorial covers [R for Datas Science (2e)](https://r4ds.hadley.nz/) by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund. You will learn how to plot data from the **babynames** dataset.


## Plotting Babynames
### 

In this section we are going to focus on generating code to create a graph based on our dataset called babynames. The `babynames` is a data set which contained names used for babies from 1880 to 2017. If you want to explore the data set, checkout [popular baby names](https://www.ssa.gov/oact/babynames/limits.html). We will be using AI to generate the code for us and then we will break down the functions within the code and how they work.

###

### Exercise 1

Create a Github repo called `babynames`. Make sure to click the "Add a README file" check box.

Connect the repo to a project on your computer using `File -> New Folder from Git ...`. Make sure to select the "Open in a new window" box. 

You need two Positon windows: this one for running the tutorial and the one you just created for writing your code and interacting with the Console.

Select `File -> New File -> Quarto Document ...`. Provide a title -- `"Babynames"` -- and an author (you). Render the document and save it as `analysis.qmd`.

Create a `.gitignore` file with `analysis_files` on the first line and then a blank line. Save and push.

In the Console, run:

```         
show_file(".gitignore")
```

If that fails, it is probably because you have not yet loaded `library(tutorial.helpers)` in the Console.

CP/CR.

```{r ai-usage-1}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

Professionals keep their data science work in the cloud because laptops fail.


### Exercise 2

Load the **tidyverse** library in your QMD. CP/CR

```{r ai-usage-2}
question_text(NULL,
    message = "library(tidyverse)",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 2)
``` 

###

Tidyverse is a package that allows us to do datascience in R.


### Exercise 3

Install the dataset we will use today: **babynames**. Add install.packages(babynames) to your QMD. CP/CR

```{r ai-usage-3}
question_text(NULL,
    message = "install.packages(babynames)",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 2)
``` 

###

Babynames is the dataset that we will be working with today. 


### Exercise 4

Load the **babynames** dataset in your QMD. CP/CR

```{r ai-usage-4}
question_text(NULL,
    message = "library(babynames)",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 2)
``` 

###

We load babynames into our current QMD so it is accessible to use with the rest of the code in the document.


### Exercise 5

Print out **babynames** to view the dataset. CP/CR

```{r ai-usage-5}
question_text(NULL,
    message = "print(babynames)",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 10)
``` 

###

Typing out babynames is the same as typing out print(babynames). Either way, we can see the same tibble. Look around and try to understand each column.


### Exercise 6

Using your favorite AI, prompt it to generate R code that takes the **babynames** and filters out all names that have a first name starting with A. Make sure to provide a tibble of **babynames** for the AI to use. Add the code to your QMD and render to check if it works. CP/CR the code.

```{r ai-usage-6}
question_text(NULL,
	message = "Here is our generated code:\na_names <- babynames %>%
  filter(str_starts(name, \"A\"))",
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	incorrect = NULL,
	rows = 4)
```

###

The filter() function is used for subsetting data frames by selecting rows that satisfy specific conditions. In this case, it takes rows using str_starts() () (a string function we covered earlier), which essentially takes a column (name), and selects the rows where the string of name starts with A.

###

Replace your code with ours to follow along with the tutorial.


### Exercise 7

Next, prompt AI to generate R code that makes a new subset with the total proportion of babies with first names starting with A for each sex, from each year.

```{r ai-usage-7}
question_text(NULL,
	message = "Here is our generated code:\na_summary <- a_names %>%
  group_by(year, sex) %>%
  summarise(total_prop = sum(prop), .groups = \"drop\")",
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	incorrect = NULL,
	rows = 5)
```

###

The function group_by() allows us to split a data frame into groups based on one or more variables, and then apply a function to each group to manipulate our data. Then, summarize() creates a new data frame with rows, in this case each row is a year and sex combination with the total proportion of names starting with A.


### Exercise 8

Now, using the same AI and the code above, ask it to generate R code that plots a basic graph showing the proportion of names starting with A over the years for each sex. CP/CR your code.

```{r ai-usage-8}
question_text(NULL,
	message = "Here is our generated code:\n
ggplot(a_summary, aes(x = year, y = total_prop, color = sex)) +
  geom_line(size = 1.2) +
  labs(
    title = \"Proportion of Babies with Names Starting with 'A' Over Time\",
    x = \"Year\",
    y = \"Proportion\",
    color = \"Sex\"
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1)) +
  theme_minimal()
",
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	incorrect = NULL,
	rows = 10)
```

###

Take the code we have provided you, and add it to your QMD. Now you should have a code chunk that loads **babynames**, filters it, and creates a plot based off of it. Render it to check that it works. We will now dissect the code that plots the data.


### Exercise 9

Find the line with ggplot() and aes(). Run ?ggplot and ?aes within the console to see what the functions do. In a few sentences of your own words, describe what they do and what arguments they take.

```{r ai-usage-9}
question_text(NULL,
    message = NULL,          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 3)
``` 

###

**ggplot()** creates the basis for the graph while **aes()** maps the arguments x and y to the axis. Changing the variables set to x and y will change what is plotted.


### Exercise 10

Next, find the line with **geom_line()**. Run ?geom_line to find out what it does. Then, using AI or Google, find other geom_*() functions and learn what they do. Pick 3 functions and describe with a sentence each below.

```{r ai-usage-10}
question_text(NULL,
    message = NULL,          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 5)
``` 

###

Arguments within geom_line() change the appearance of the graph, but will not change the type of graph. The function geom_line() is what gives the plotted line on the graph. To make it a histogram, use geom_histogram(), to make a scatterplot, use geom_point(), etc.


### Exercise 11

Next, find the line with **labs()** and the lines following it containings its arguments. If not already there, add **caption = ""** and **subtitle = ""**. Change around the names of the titles. CP/CR your complete **labs()** function.

```{r ai-usage-11}
question_text(NULL,
    message = "labs() provides titles and labels to the graph.",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 5)
``` 

###

The title should capture the purpose of your graph, the subtitle should be a noticeable takeaway, the x and y axis should be fitting labels with units, and the caption should give the source of the data.


## Using Other String Functions on Babynames
###

In this section we are going to focus on generating code to create a graph based on our dataset called babynames. The `babynames` is a data set which contained names used for babies from 1880 to 2017. If you want to explore the data set, checkout [popular baby names](https://www.ssa.gov/oact/babynames/limits.html). 

### Exercise 1

Make a new code cell, using AI, get code that pipes **babynames** to filter() with name and str_starts() to find all names beginning with a certain string. Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-1}
question_text(NULL,
    message = "Here's our code:\nbabynames %>% filter(str_starts(name, \"A\"))",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 3)
``` 

###

The function str_starts() returns TRUE if each string starts with the given pattern.


### Exercise 2

Next, get code that pipes **babynames** to filter() with name and str_ends() to find all names ending with a certain string. Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-2}
question_text(NULL,
    message = "Here's our code:\nbabynames %>% filter(str_ends(name, \"y\"))",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 3)
``` 

###

The function str_ends() returns TRUE if each string ends with the given pattern.


### Exercise 3

Next, get code that pipes **babynames** to filter() with name and str_detect() to find all names containing a certain string. Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-3}
question_text(NULL,
    message = "Here's our code:\nbabynames %>% filter(str_detect(name, \"lex\"))",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 3)
``` 

###

The function str_detect() returns TRUE if each string contains the given pattern somewhere inside.


### Exercise 4

Next, get code that pipes **babynames** to mutate() with str_to_lower() and str_to_upper() to make new columns in the dataset that convert the string names to different cases. Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-4}
question_text(NULL,
    message = "Here's our code:\nbabynames %>%
  mutate(lowercase = str_to_lower(name),
         uppercase = str_to_upper(name))",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 5)
``` 

###

The functions str_to_lower() and str_to_upper() convert all characters in the string to their respective case.


### Exercise 5

Next, get code that pipes **babynames** to mutate() with str_length() and then filter() to get all names that are X letters long. Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-5}
question_text(NULL,
    message = "Here's our code:\nbabynames %>%
  mutate(length = str_length(name)) %>%
  filter(length == 10)",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 5)
``` 

###

The function str_length() returns the number of characters in each string.


### Exercise 6

Next, get code that pipes **babynames** to mutate() with str_sub() twice to obtain the first and last letter of each name. Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-6}
question_text(NULL,
    message = "Here's our code:\nbabynames %>%
  mutate(first_letter = str_sub(name, 1, 1),
         last_letter = str_sub(name, -1, -1))",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 5)
``` 

###

The function str_sub() extracts a substring from a string by position.


### Exercise 7

Next, get code that pipes **babynames** to filter() and detect all names with an "a", then pipe it to mutate() with str_replace_all() to create a new column that replaces all the "a"s with an "x". Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-7}
question_text(NULL,
    message = "Here's our code:\nbabynames %>%
  filter(str_detect(name, \"a\")) %>%
  mutate(modified = str_replace_all(name, \"ph\", \"f\"))",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 5)
``` 

###

The functions str_replace() and str_replace_all() replace the first match of a pattern in each string.


### Exercise 8

Next, get code that pipes **babynames** to mutate() with str_count() to make a new column that counts how many "a"s each name have. Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-8}
question_text(NULL,
    message = "Here's our code:\nbabynames %>%
  mutate(num_a = str_count(name, \"a\"))",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 3)
``` 

###

The function str_count() counts the number of times a pattern appears in each string.


### Exercise 9

Next, get code that pipes **babynames** to distinct() and then to mutate() with str_sort() to changes the name column so that it orders the distinct names alphabetically. Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-9}
question_text(NULL,
    message = "Here's our code:\nbabynames %>%
  distinct(name) %>%
  mutate(name = str_sort(name, locale = \"en\", decreasing = FALSE))",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 5)
``` 

###

The function str_sort() sorts strings alphabetically, optionally by locale or in reverse. Locale refers to the language rules to follow for sorting.


### Exercise 10

Next, get code that pipes **babynames** to mutate() with str_trim() to create a new column with trimmed names. Run the code to get a new subset of data and print it out. CP/CR

```{r string-functions-10}
question_text(NULL,
    message = "Here's our code:\nbabynames %>%
  mutate(clean_name = str_trim(name))",          
    answer(NULL, 
           correct = TRUE),
    allow_retry = TRUE,
    incorrect = NULL,
    rows = 3)
``` 

###

The function str_trim() removes whitespace from the start and/or end of strings.


## Summary
### 

This tutorial covered [R for Datas Science (2e)](https://r4ds.hadley.nz/) by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund. You learned how to plot data from the **babynames** dataset.

```{r download-answers, child = system.file("child_documents/download_answers.Rmd", package = "tutorial.helpers")}
```
