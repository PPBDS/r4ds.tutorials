---
title: Data visualization
author: Anish Bellamkonda
tutorial:
  id: data-visualization
output:
  learnr::tutorial:
    progressive: yes
    allow_skip: yes
runtime: shiny_prerendered
description: 'Tutorial for Chapter 2: Data Visualization'
---

```{r setup, include = FALSE}
library(learnr)
library(tutorial.helpers)
library(tidyverse)
library(palmerpenguins)
library(primer.data)
knitr::opts_chunk$set(echo = FALSE)
options(tutorial.exercise.timelimit = 60, 
        tutorial.storage = "local") 

globe_temps <- temperature |> 
  filter(area == "globe") |> 
  select(date, temperature)

savings <- economics |> 
  select(date, psavert)

usbmi <- nhanes |> 
  select(bmi) |>
  drop_na()
```

```{r copy-code-chunk, child = system.file("child_documents/copy_button.Rmd", package = "tutorial.helpers")}
```

```{r info-section, child = system.file("child_documents/info_section.Rmd", package = "tutorial.helpers")}
```

<!-- Make hint code follow style guide and be consistent question to question. -->

## Introduction
### 

This tutorial covers [Chapter 2: Data Visualization](https://r4ds.hadley.nz/data-visualize.html) from [*R for Data Science (2e)*](https://r4ds.hadley.nz/) by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund.

## Creating first ggplot
### 

Our ultimate goal in this section is to create a plot displaying the relationship between flipper lengths and body masses of these penguins, taking into consideration the species of the penguin.Before doing so, lets load the **palmerpenguins** package using `library()`.

### Exercise 1

```{r creating-first-ggplo-1, exercise = TRUE}

```

```{r creating-first-ggplo-1-hint-1, eval = FALSE}
library(palmerpenguins)
```

### 

A `variable`: a quanitty, quality, or property that you can measure, `value`: state of a variable when you measure it, `observation`: a set of measurements made under similiar conditions.

### Exercise 2

Run `?palmerpenguins`. After doing so, copy and paste the description here.

```{r creating-first-ggplo-2}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

The data include size measurements, clutch observations, and blood isotope ratios for adult foraging Adélie, Chinstrap, and Gentoo penguins observed on islands in the Palmer Archipelago near Palmer Station, Antarctica. 

### Exercise 3

Run the `library()` command with `ggthemes` as the argument.

```{r creating-first-ggplo-3, exercise = TRUE}

```

```{r creating-first-ggplo-3-hint-1, eval = FALSE}
library(ggthemes)
```

### 

We can infer from the name of the package itself that `ggthemes` is used for aesthetic looks of a graph and make it fancy.



### Exercise 4

Type `penguins` and hit Run Code.


```{r creating-first-ggplo-4, exercise = TRUE}

```

```{r creating-first-ggplo-4-hint-1, eval = FALSE}
penguins
```

### 

Tabular data is a set of values, each associated with a variable and an observation. Tabular data is tidy if each value is placed in its own “cell”, each variable in its own column, and each observation in its own row. `penguins` is tabular data.

### Exercise 5

Run `glimpse()` with `penguins` as its argument.

```{r creating-first-ggplo-5, exercise = TRUE}

```

```{r creating-first-ggplo-5-hint-1, eval = FALSE}
glimpse(...)
```

### 

In RStudio, you can click on the name of the data frame in the Environment pane or run `View(penguins)` to open an interactive data viewer.

### Exercise 6

<!-- Teach what a pipe is  -->

The key command for making plots is `ggplot()` from the **ggplot2** package. Run `ggplot(data = penguins)`.

```{r creating-first-ggplo-6, exercise = TRUE}

```

```{r creating-first-ggplo-6-hint-1, eval = FALSE}
ggplot(data = penguins)
```

### 

### Exercise 7

Run `sqrt(16)`

```{r creating-first-ggplo-7, exercise = TRUE}

```

```{r creating-first-ggplo-7-hint-1, eval = FALSE}
sqrt(16)
```

### 

### Exercise 8

Run `16 |> sqrt()`
```{r creating-first-ggplo-8, exercise = TRUE}

```

```{r creating-first-ggplo-8-hint-1, eval = FALSE}
16 |> sqrt()
```

### 

The difference between the previous code was it that we are using the pipe operator `|>` which takes anything from the left side and plugs it into the function in the right side.

### Exercise 9

Run `penguins` with the pipe operator `|>` and plug it into `ggplot()` like this
`penguins |> ggplot()`
```{r creating-first-ggplo-9, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-9-hint-1, eval = FALSE}
penguins |>
  ggplot()
```

### 

penguins which is the input is being plugged into the function `ggplot()` which gives the same output as `ggplot(data = penguins)`. While Indentation may not affect code, it is a good habit to do because it helps go through the code much faster.




### Exercise 10

Copy the previous code and within `ggplot()`, run `mapping = aes(x = flipper_length_mm)` and see what you get.
```{r creating-first-ggplo-10, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-10-hint-1, eval = FALSE}
penguins |>
  ggplot(... = aes(x = ...))
```

### 

`mapping = aes(x = flipper_length_mm)` specifies that the variable `flipper_length_mm` is mapped to the x-axis of a plot. This allows the length of the penguin's flipper to be plotted on the x-axis.

### Exercise 11

Copy the previous code, within the `aes()` set `y` equal to `body_mass_g` and run it.
```{r creating-first-ggplo-11, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-11-hint-1, eval = FALSE}
penguins |>
  ggplot(mapping = aes(x = ..., y = ...))
```

To display the data points we need to add a geometric object(geom). We can define a `geom`: the geometrical object that a plot uses to represent data. These geometric objects are made available in ggplot2 with functions that start with `geom_`. 

### 

### Exercise 12

The function `geom_point()` adds a layer of points to your plot, which creates a scatterplot so copy the previous code and run `+ geom_point()`

```{r creating-first-ggplo-12, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-12-hint-1, eval = FALSE}
penguins |>
  ...(
    mapping = aes(x = flipper_length_mm, y = ...)
    ) +
  geom_point()
```

### 

`geom_point()` is not the only geometric objects, there are more than this single one and we will learn about them in other sections in this tutorial.

### Exercise 13

Within `aes()`, run `color = species`.
```{r creating-first-ggplo-13, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-13-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = aes(x = flipper_length_mm, y = ..., ... = species)
)+
  geom_point()
```

### 

Scatter plot are useful for displaying relationship between x and y but it is also helpful to ask yourself if there are other variable which might contribute to the relationship. For example, does the relationship between x and y differ for different species of penguins.

When you ran it, you see that the data points differ by the color of the species which just makes the scatter plot more insightful. Color isnt just the only aesthetics. There are more, to find out more go check out [aesthetic mappings](https://ggplot2.tidyverse.org/reference/aes.html)


### Exercise 14

Copy the previous code, run `geom_smooth()` and within it, set `method` to `lm`. 
```{r creating-first-ggplo-14, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-14-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = aes(x = flipper_length_mm, y = body_mass_g, color = ...)
) +
  geom_point() +
  geom_smooth(... = "lm")
```

### 

`geom_smooth()`: used to add a smooth curve to a scatterplot, which can help identify trends and patterns in data by fitting a line or smoothing function. It offers different smoothing methods like linear or polynomial regression and loess smoothing


### Exercise 15

We have added new lines to the plot, but it does not match the plot in beginning, which displayed only one line for the entire dataset instead of separate lines for each penguin species. Remove the `color` aesthetic within `ggplot()` and add it to `geom_point` by running `geom_point(mapping = aes(color = species))`


```{r creating-first-ggplo-15, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-15-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = ...(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(mapping = ...(color = species)) +
  ...(method = "lm")
```

### 

In **ggplot2**, when aesthetic mappings are defined at the global level, they are passed down to all subsequent geom layers in the plot. However, each geom function in ggplot2 can also accept a mapping argument, allowing for local-level aesthetic mappings that are added to those inherited from the global level. 

### Exercise 16

Not all individuals perceive colors differently due to color blindness or other color vision differences. Therefore,  map the `species` to the `shape` aesthetic in addition to `color` within `geom_point()`.
`
```{r creating-first-ggplo-16, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-16-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(mapping = aes(color = ..., shape = ...)) +
  geom_smooth(method = "lm")
```

### 

### Exercise 17

Now that we have the data points, lets add the title, substitle, labels and etc. Copy the previous code,   add a new layer using `+` and run `labs()`. Within labs, set `title` equal to "Body mass and flipper length" in quotes.

```{r creating-first-ggplo-17, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-17-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(mapping = aes(color = species, shape = species)) +
  geom_smooth(method = "lm")+
  labs( ... = "Body mass and flipper length")
```

### 

### Exercise 18

Copy the previous code, lets add the subtitle by running `subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins"` after the title.

```{r creating-first-ggplo-18, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-18-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(mapping = aes(color = species, shape = species)) +
  geom_smooth(method = "lm") +
  labs( ... = "Body mass and flipper length",
        subtitle = "...")
```

### 

### Exercise 19

Lets modify the x and y axises, type a comma and then run `x` and set it to `"Flipper Length (mm)"`  Type another comma and a `y`, then set it equal to "Body mass (g)" in quotes.

```{r creating-first-ggplo-19, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-19-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(mapping = aes(color = species, shape = species)) +
  geom_smooth(method = "lm") +
  labs( ... = "Body mass and flipper length"+
          subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
        x = ...)
```

### 

### Exercise 20

Next to `x` axis label, type another comma and a `y`, then set it equal to `"Body mass (g)"` in quotes.

```{r creating-first-ggplo-20, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-20-hint-1, eval = FALSE}
... |> 
  labs(... = "Body mass and flipper length",
       subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
       x = ..., 
       y = ...)
```

### 

### Exercise 21

You might see that it looks the same as the one in the beginning but we forgot one minor thing which is capitalizing the legend, we can do so by typing a comma and setting both `color` and `shape` equal to "Species" in quotes.
```{r creating-first-ggplo-21, exercise = TRUE}
penguins |>
  ggplot(
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(mapping = aes(color = species, shape = species)) +
  geom_smooth(method = "lm")+
  labs( ... = "Body mass and flipper length"+
          subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
        x = ..., y = ...,
         color = "Species", shape = "Species")
```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-first-ggplo-21-hint-1, eval = FALSE}

```

### 

## geom_point
### 

To practice the new skills we learned from the plot we made in the previous exercises, we will make another plot which displays the relationship between `bill_depth_mm` and `bill_lenght_mm`.

Below is what the end product will look like

```{r}
#| message: false
#| warning: false

exercise_scatterplot_p <- penguins |>
  ggplot(mapping = aes(x = bill_length_mm, 
                       y = bill_depth_mm, 
                       color = species, 
                       shape = species)) +
    geom_point() +
    geom_smooth(method = "lm") +
    labs(title = "Penguins Beak's Length and Depth", 
        subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
        x = "Beak Length (mm)", 
        y = "Beak Depth (mm)",
        color = "Species", 
        shape = "Species")

exercise_scatterplot_p
```

### Exercise 1

Run `penguins` with the pipe operator `|>` and plug it into `ggplot()` 

```{r geompoint-1, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geompoint-1-hint-1, eval = FALSE}
penguins |>
  ggplot()
```

### 

### Exercise 2

Copy the previous code and within `ggplot()`, set `x` to `bill_length_mm`.

```{r geompoint-2, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geompoint-2-hint-1, eval = FALSE}
penguins |>
  ggplot(... = aes(x = ...))
```

### 

### Exercise 3

Copy the previous code, within the `aes()`, set `y` to `bill_depth_mm` and run it.

```{r geompoint-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geompoint-3-hint-1, eval = FALSE}
penguins |>
  ggplot(mapping = aes(x = ..., y = ...))
```

### 

### Exercise 4

Copy the previous code and run `+ geom_point()`

```{r geompoint-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geompoint-4-hint-1, eval = FALSE}
... |> 
  geom_point()
```

### 

The warning message "Removed X rows containing missing values (geom_point())" is a common message in R when working with data visualization using ggplot2 package. It indicates that there were rows in the data that contained missing values (i.e., NA values) in the columns being used for plotting the points with `geom_point()`, and you will see it many times throughout this tutorial.



### Exercise 5

Within `aes()`, run `color = species`.

```{r geompoint-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geompoint-5-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = aes(x = bill_length_mm, 
                y = ..., 
                ... = species)
  ) +
  geom_point()
```

### 

### Exercise 6

Copy the previous code, run `geom_smooth()` and within it, set `method` to `lm`. 

```{r geompoint-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geompoint-6-hint-1, eval = FALSE}
... |> 
  geom_smooth(... = "lm")
```

### 

### Exercise 7

Remove the `color` aesthetic within `ggplot()` and add it to `geom_point()` by running `geom_point(mapping = aes(color = species))` to get three different lines for each species.


```{r geompoint-7, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geompoint-7-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = ...(x = bill_length_mm, y = bill_depth_mm)
) +
  geom_point(mapping = ...(color = species)) +
  ...(method = "lm")
```

### 

### Exercise 8

Map the `species` variable to the `shape` aesthetic in addition to `color` within `geom_point()`.
`
```{r geompoint-8, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geompoint-8-hint-1, eval = FALSE}
penguins |>
  ggplot(
  mapping = aes(x = bill_length_mm, y = bill_depth_mm)
) +
  geom_point(mapping = aes(color = ..., shape = ...)) +
  geom_smooth(method = "lm")
```

### 

### Exercise 9

Now that we have the data points, lets add the title, subtitle, labels and etc. Copy the previous code,   add a new layer using `+` and run `labs()`. Within labs, set `title` equal to "Penguins Beak's Length and Depth" , `subtitle` to "Dimensions for Adelie, Chinstrap, and Gentoo Penguins" , `x` to  "Beak Length (mm)", `y = "Beak Depth (mm)"`, `color` to "Species" and `shape` to "Species".

```{r geompoint-9, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geompoint-9-hint-1, eval = FALSE}
penguins |>
  ggplot(mapping = aes(x = ..., y = bill_depth_mm, color = ... , shape = species) )+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(title = "Penguins Beak's Length and Depth", 
       subtitle = ...,
       x = ... , 
       ... = "Beak Depth (mm)",
       color = "Species", 
       ... = "Species")
```

Reminder: This is what our graph should look like

```{r}
#| message: false
#| warning: false

exercise_scatterplot_p <- penguins |>
  ggplot(mapping = aes(x = bill_length_mm, 
                       y = bill_depth_mm, 
                       color = species, 
                       shape = species)) +
    geom_point() +
    geom_smooth(method = "lm") +
    labs(title = "Penguins Beak's Length and Depth", 
        subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
        x = "Beak Length (mm)", 
        y = "Beak Depth (mm)",
        color = "Species", 
        shape = "Species")
exercise_scatterplot_p

```

### 

## geom_bar
### 

To examine the distribution of a categorical variable, variables that represent categories or groups of items, we can the bar chart to do so.


### Exercise 1

load the `palmerpenguins` library

```{r geombar-1, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geombar-1-hint-1, eval = FALSE}
library(palmerpenguins)
```

### 

### Exercise 2

Run `penguins` and pipe it to a `ggplot()` call.

```{r geombar-2, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geombar-2-hint-1, eval = FALSE}
penguins |>
  ggplot()
```

`geom_bar()` is used to represent categorical data: Bar charts are commonly used to represent categorical data. The x-axis represents the categories and the height of the bars represents the frequency or count of the observations in each category.

### 

### Exercise 3

Within `ggplot()`, set `x` to `species` inside of `aes()`

```{r geombar-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geombar-3-hint-1, eval = FALSE}
penguins |>
  ...(aes(x = species))
```

By default, `geom_bar()` counts the number of observations in each category: If you use `geom_bar()` without specifying any other arguments, it will count the number of observations in each category and create a bar chart showing the frequency of each category.

### 

### Exercise 4

To make the bar graph, add `geom_bar()` call and run it.`

```{r geombar-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geombar-4-hint-1, eval = FALSE}
penguins |>
  ...(aes(x = species))+
  geom_...()
```

### 

### Exercise 5

To make the graph be in order, set `x` to `fct_infreq(species)`.

```{r geombar-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geombar-5-hint-1, eval = FALSE}
penguins |>
  ...(aes(x = ...(species)))+
  geom_...()
```

What `fct_infreq()` does that it changes the order of levels with each level. If you want to know more visit [https://forcats.tidyverse.org/reference/fct_inorder.html] here!

### 

### Exercise 6

Lets integrate another categorical variable, so set `fill` to `species` within `aes()`.

```{r geombar-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geombar-6-hint-1, eval = FALSE}
penguins |>
  ...(aes(x = ...(species, fill = species)))+
  geom_...()
```

You can customize the order of the bars: By default, geom_bar orders the bars in ascending order based on the category. However, you can customize the order of the bars using the reorder function.

### 

### Exercise 7

Let's find the percentages of each penguins species on each island, so run `position = "fill"` within `geom_bar()`.

```{r geombar-7, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geombar-7-hint-1, eval = FALSE}
penguins |>
  ...(aes(x = ...(species, fill = species)))+
  geom_...(postion = "fill")
```

`geom_bar()` can be used with faceted data: `geom_bar()` can create faceted bar charts, where the bars are split into multiple panels based on a third variable. To do this, you can use the facet_wrap or facet_grid function. 

### 

### Exercise 8

Now use `labs()` to set an appropriate title, subtitle, axes labels, and caption for the graph.

```{r geombar-8, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geombar-8-hint-1, eval = FALSE}
penguins |>
  ggplot(aes(x = island, fill = species)) +
    geom_bar(position = "fill")+
    labs(title = "",
         subtitle = "",
         x = "",
         y = "",
         caption = "",
         fill = "
         ")
```

Reminder : This is what our graph should look like.

```{r}
#| message: false
#| warning: false
library(ggplot2)
library(palmerpenguins)


geom_bar_p <- penguins |>
  ggplot(aes(x = island, fill = species)) +
    geom_bar(position = "fill")+
    labs(title = "Percentage of Penguins in Different Islands",
         subtitle = "The Adelie species is the species on Torgersen",
         x = "Island",
         y = "Percentage",
         caption = "Data: PalmerPenguins",
         fill = "Species")
geom_bar_p
```

### 

## geom_histogram
### 

To visualize the distribution of a continuous variable, we will be using `geom_histogram()` and it is very useful when you want to understand the deviation of data.

### Exercise 1

Use the `library()` function to load the `palmerpenguins` package.

```{r geomhistogram-1, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomhistogram-1-hint-1, eval = FALSE}
library(palmerpenguins)
```

### 

A continuous variable is a variable that can take on any value within a certain range or interval. It can be measured on a continuous scale, such as time, distance, weight, height, temperature, or any other quantity that can be measured on a numerical scale.



### Exercise 2

Run `penguins` and pipe it to a `ggplot()` call.

```{r geomhistogram-2, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomhistogram-2-hint-1, eval = FALSE}
penguins |> 
  ggplot()
```

### 

`geom_histogram()` creates a histogram: geom_histogram is used to create histograms, which are used to visualize the distribution of a single continuous variable. Histograms show the frequency of values within a certain range, which are typically represented by bins along the x-axis.



### Exercise 3

Within, set `x` to `body_mass_g`.

```{r geomhistogram-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomhistogram-3-hint-1, eval = FALSE}
penguins |> 
  ggplot(x = body_mass_g)

```

You can add a density curve to the histogram: You can add a density curve to the histogram to show the underlying distribution of the data. To do this, you can use the stat_density function.The `..density..` aesthetic is used to scale the histogram bars to be a density instead of a count, and the `alpha` parameter is used to make the bars semi-transparent so that the density curve is visible.

### 

### Exercise 4

Add the `geom_histogram()` layer to make the plot.

```{r geomhistogram-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomhistogram-4-hint-1, eval = FALSE}
penguins |> 
  ggplot(x = body_mass_g)+
  geom_...()
```

You can adjust the position of the bars: By default, `geom_histogram()` positions the bars to touch each other. However, you can adjust the position of the bars using the position parameter.

### 

### Exercise 5

Within `geom_histogram()`, set `binwidth` to 20.

```{r geomhistogram-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomhistogram-5-hint-1, eval = FALSE}
penguins |> 
  ggplot(x = body_mass_g)+
  geom_...(binwidth = ...)
```

The binwidth parameter controls the width of the bins: The binwidth parameter controls the width of the bins used in the histogram. By default, geom_histogram uses a binwidth of 30. Compared to the previews histogram, the 20 bin width is too narrow, resulting in too many bars, making it difficult ot determine the shape of the distribution. 

### 

### Exercise 6

Now, set `binwidth` to 200 and see the difference.

```{r geomhistogram-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomhistogram-6-hint-1, eval = FALSE}
penguins |> 
  ggplot(x = body_mass_g)+
  geom_...(binwidth = ...)
```

Looking at this histogram, we can see that it is much better because we can actually define the shape and see the distribution.

### 

### Exercise 7

Now use `labs()` to set an appropriate title, subtitle, axes labels, and caption for the graph.

```{r geomhistogram-7, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomhistogram-7-hint-1, eval = FALSE}

```

### 

## geom_density
### 

An alternate way to visualize the distributions of data on a continuous variable is to use `geom_density()` which is smoothed-out-version of a histogram.

### Exercise 1

load the `palmerpenguins` library

```{r geomdensity-1, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomdensity-1-hint-1, eval = FALSE}
library(palmerpenguins)
```

`geom_density()` is a function in the ggplot2 package in R used for creating density plots.

### 

### Exercise 2

Run `penguins` and pipe it to a `ggplot()` call.

```{r geomdensity-2, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomdensity-2-hint-1, eval = FALSE}
penguins |>
  ggplot()
```

### 

### Exercise 3

In ggplot, set `x` to `body_mass_g` within `aes()`

```{r geomdensity-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomdensity-3-hint-1, eval = FALSE}
penguins|>
  ggplot(aes(x = body_mass_g))
```

### 

A density plot is a graphical representation of the distribution of a continuous variable. It shows the density of data points along the x-axis, where the height of the curve represents the density of data points at that particular point on the x-axis.




### Exercise 4

Now add the `geom_density()` call.

```{r geomdensity-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomdensity-4-hint-1, eval = FALSE}
penguins |>
  ggplot(aes(x = ...))+
  geom_density()
```

### 

The `geom_density()` function takes in a data frame, and then maps the x-axis to a continuous variable in that data frame. It calculates the density of data points for each x-value and creates a smooth curve to represent the density distribution.



### Exercise 5

The previous graph shows the distribution for all the species combined, so now lets show distribution for the three species. Within `aes()`, set `color` to `species`.

```{r geomdensity-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomdensity-5-hint-1, eval = FALSE}
penguins |>
  ggplot(aes(x = ..., color = ...))+
  geom_density()
```

### 

The geom_density() function can be customized using various arguments, such as adjust to control the smoothness of the curve, and bw to set the bandwidth of the kernel density estimate used to generate the curve.




### Exercise 6

Run `fill = species` within `aes()`.

```{r geomdensity-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomdensity-6-hint-1, eval = FALSE}
penguins |>
  ggplot(aes(x = ..., color = ..., fill = ...))+
  geom_density()
```

### 

### Exercise 7

To make the graph transparent, run `alpha = 0.5` within `geom_density()` call.

```{r geomdensity-7, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomdensity-7-hint-1, eval = FALSE}
penguins |>
  ggplot(aes(x = ..., color = ..., fill = ...))+
  geom_density(alpha = ...)
```

### 

Density plots are useful for visualizing the distribution of a continuous variable, especially when you have a large number of data points. They can be used to identify the location and spread of the data, as well as any outliers or skewness in the distribution.



### Exercise 8

Finally set an appropriate title, subtitle, axes labels, and caption for the graph.

```{r geomdensity-8, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomdensity-8-hint-1, eval = FALSE}

```

### 

Reminder: This is what your graph should look like.

```{r}
density_p <- penguins |>
  ggplot(aes(x = body_mass_g, 
             color = species, 
             fill = species)) +
  geom_density(alpha = .5) +
  labs(title = "Distribution of Body Mass by Penguin Species",
       x = "Bill Length (mm)",
       y = "Density",
       fill = "Species",
       color = "Species")

density_p
```

## geom_boxplot
### 

To visualize the relationship between a numerical and a categorical variable we can use `geom_boxplot()`. A box plot is a type of visual shorthand for measures of position (percentiles) that describe a distribution.


```{r}
knitr::include_graphics("images/EDA-boxplot.png")
```

Box plots are a type of data visualization that summarize the distribution of a continuous variable using five key statistics: minimum, lower quartile (Q1), median, upper quartile (Q3), and maximum. The box itself in the plot represents the middle 50% of the data, with the median shown as a horizontal line inside the box. The whiskers extend from the box to show the range of the data, and individual data points that fall outside of the whiskers are shown as individual points (outliers).


### Exercise 1

load the `palmerpenguins` library
```{r geomboxplot-1, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomboxplot-1-hint-1, eval = FALSE}
library(palmerpenguins)
```

Box plots, also known as box-and-whisker plots, are a type of data visualization used to display the distribution of a continuous variable. They were first introduced by John W. Tukey in 1977.

### 

### Exercise 2

Run `penguins` and pipe it to a `ggplot()` call.
```{r geomboxplot-2, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomboxplot-2-hint-1, eval = FALSE}
penguins |>
  ggplot()
```

### 

### Exercise 3

In `ggplot()` within `aes()`, set `x` to `species`.

```{r geomboxplot-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomboxplot-3-hint-1, eval = FALSE}
penguins |>
  ggplot(aes(x = species))
```

### 

The `geom_boxplot()` function can be customized using various arguments, such as  alpha to adjust the transparency of the box, and notch to create a notch in the box to indicate the confidence interval of the median.



### Exercise 4

Set `y` to `body_mass_g`.

```{r geomboxplot-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomboxplot-4-hint-1, eval = FALSE}
penguins |>
  ggplot(aes(x = species, y = body_mass_g))
```

### 

Box plots are useful for comparing the distribution of a continuous variable across different categories or groups. They can help identify differences in the median, spread, and skewness of the data for each group.


### Exercise 5

Add `geom_boxplot()` to demonstrate the distribution of body mass for different species.

```{r geomboxplot-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomboxplot-5-hint-1, eval = FALSE}
penguins |>
  ggplot(aes(x = species, y = body_mass_g))+
  geom_boxplot()
```

### 

By default, `geom_boxplot()` does not display the underlying data points that fall outside of the whiskers (i.e., the outliers). However, it can be useful to visualize these points, especially if they are few in number or if they represent important values. One way to do this is to add the `outlier.color` and `outlier.shape` arguments to `geom_boxplot()`, which will display the outlier points in a different color and shape.


### Exercise 6

Finally set an appropriate title, subtitle, axes labels, and caption for the graph.

```{r geomboxplot-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomboxplot-6-hint-1, eval = FALSE}
ggplot(penguins, aes(x = species, y = body_mass_g)) +
                  geom_boxplot()+
                  labs(title = "...",
                       subtitle = "...",
                       x = "Species",
                       y = "Body Mass(g)"
                       )

```

Reminder: This is what your graph should look like.

```{r}
box_plot_p <- ggplot(penguins, aes(x = species, y = body_mass_g)) +
                  geom_boxplot()+
                  labs(title = "Body Mass Distribution of Palmer Penguins by Species: A Boxplot Analysis",
                       subtitle = "Comparing the Median and Variability of Body Mass for Adelie, Chinstrap, and Gentoo Penguins",
                       x = "Species",
                       y = "Body Mass(g)",
                       )
box_plot_p
```

### 

<!-- DK: Continue book material here. Below are extra plots practice which comes from the Visualization: Basic Plots tutorial from all.primer.tutorials. -->

<!-- Is this good material? Should we add it elsewhere in the tutorial? Maybe we have two geom_smooth examples, one from the book and then our new one right after it?  -->

<!-- Everything below is sloppy and much of it lacks good knowledge drops. -->

<!-- Make sure your section names are not duplicative! If they are, Format Tutorial Chunk Labels will (?) not work. -->

## More practice
### 

You have now completed all the material in the chapter. But you can never get enough practice plotting. So, practice some more.

## geom_smooth with savings
### 

We can add straight or smoothed lines which follow the path of our data using `geom_smooth()`.

Let's create the following plot with the `savings` dataset.

```{r make-smooth-p}
smooth_p <- savings |>  
  ggplot(aes(x = date, y = psavert)) +
    geom_point() +
    geom_smooth(method = 'loess', formula = 'y ~ x', se = FALSE) +
  labs(title = "U.S. Personal Savings Rate",
       subtitle = "Savings rate increased in the past decade",
       x = "Year",
       y = "Percent disposable personal income saved",
       caption = "U.S. Bureau of Economic Analysis (2021)")
smooth_p
```

### Exercise 1

Let's first explore the `savings` dataset using `glimpse()`.

```{r geomsmooth-with-savi-1, exercise = TRUE}

```

```{r geomsmooth-with-savi-1-hint-1, eval = FALSE}
glimpse(...)
```

### 

The personal savings rate, represented here under the variable `psavert`, is calculated as a percentage of disposable personal income (DPI).

### Exercise 2

Within `ggplot()` set `data` to `savings`

```{r geomsmooth-with-savi-2, exercise = TRUE}

```

```{r geomsmooth-with-savi-2-hint-1, eval = FALSE}
ggplot(data = ...)
```

### 

`ggplot()` initializes a ggplot object. Your output should be an empty canvas.


### Exercise 3

Now, specify the **aes**thetic inside `ggplot()` for the x-axis to be the `date` and the y-axis to be `psavert`. 

```{r geomsmooth-with-savi-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomsmooth-with-savi-3-hint-1, eval = FALSE}
ggplot(data = savings,
       aes(x = ..., y = ...))
```

### 

Your output should still be empty, since we have not yet added a `geom_*` layer.

### Exercise 4

Add `geom_point()` to the layer.

```{r geomsmooth-with-savi-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomsmooth-with-savi-4-hint-1, eval = FALSE}
ggplot(data = savings,
       aes(x = date, y = psavert)) +
  geom_point()
```

### 

When points on the graphs start becoming too dense, two ways to combat this is to adjust the `alpha` value or making the `shape` a smaller value.

### Exercise 5

The plot so far looks neat, but a trend line would be helpful in identifying trends across many years. Add the layer `geom_smooth()`.

```{r geomsmooth-with-savi-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomsmooth-with-savi-5-hint-1, eval = FALSE}
ggplot(data = savings,
       aes(x = date, y = psavert)) +
  geom_point() +
  geom_smooth()
```

### 

Nice! The blue line represents our regression line, and the shaded area around it is the standard error, or what is essentially the margin of error.

### Exercise 6

Notice the warning message R gives us? Let's try setting the `method` to `"loess"` inside `geom_smooth()`.

```{r geomsmooth-with-savi-6, exercise = TRUE, warning = FALSE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomsmooth-with-savi-6-hint-1, eval = FALSE}
Remember to put "loess" in quotes within geom_smooth()
```

```{r geomsmooth-with-savi-6-hint-2, eval = FALSE}
... +
  geom_smooth(method = "...")
```

### 

If you do not specify a method, R will give you a warning that it has made some assumptions in the function. `"loess"` is short for **LO**cal regr**ESS**ion, giving us the curved line.

### Exercise 7

Great! But, we still get a message! Set the `formula` argument within `geom_smooth()` to `y ~ x`.

```{r geomsmooth-with-savi-7, exercise = TRUE}


```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomsmooth-with-savi-7-hint-1, eval = FALSE}
ggplot(data = savings, 
       mapping = aes(x = date, 
                     y = psavert)) +
  geom_point()  +
    geom_smooth(method = "loess", formula = y ~ x)
```

### 

If you do not specify `formula`, R will also give you a warning that you have not done so. By default, the formula to use in smoothing function is set to `y ~ x`.

### Exercise 8

Also set `se` to `FALSE` to get rid of the grey area surrounding the trend line.

```{r geomsmooth-with-savi-8, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomsmooth-with-savi-8-hint-1, eval = FALSE}
ggplot(data = savings, 
       mapping = aes(x = date, 
                     y = psavert)) +
  geom_point()  +
    geom_smooth(method = "loess", formula = y ~ x, se = FALSE)
```

### 

Setting the `se` parameter determines whether or not to display the confidence interval around smooth. By default it's set to `TRUE`.

### Exercise 9

Now use `labs()` to set an appropriate title, subtitle, axes labels, and caption for the graph.

```{r geomsmooth-with-savi-9, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomsmooth-with-savi-9-hint-1, eval = FALSE}
... +
  labs(title = "...",
       subtitle = "..."
       x = "...",
       y = "...",
       caption = "...")
```

Reminder: Your graph should look like this.

```{r show-smooth-p}
smooth_p
```

### 

Good work! The parameters used here may not always be the best choice. Check out this function's (documentation page)[https://ggplot2.tidyverse.org/reference/geom_smooth.html] to learn more about the other arguments for `method` and `formula`.

## geom_line wiith temperature
### 

A line graph is a plot that visualizes the relationship between two numerical variables when there is a sequential nature to the variable on the x-axis, also called the independent variable.

Let's create the following line graph via the `globe_temps` dataset,

```{r make-line-p}
globe_temps_p <- globe_temps |> 
  ggplot(aes(x = date, y = temperature)) +
    geom_line() +
    geom_smooth(method = "loess", formula = y ~ x, se = FALSE) +
    labs(title = "Global Monthly Temperature (°C) Deviations",
         subtitle = "Temperature deviations trend upward",
         x = "Year",
         y = "Global Average Deviation (°C)")

globe_temps_p
```

### 

This dataset used satellite-measured data to calculate global monthly temperature changes. The values show monthly temperature deviations in °C relative to their respective 1991-2021 average temperature.

### Exercise 1

Let's first explore the `globe_temps` dataset. Use the `summary()` function.

```{r geomline-wiith-tempe-1, exercise = TRUE}

```

```{r geomline-wiith-tempe-1-hint-1, eval = FALSE}
summary(...)
```

### 

`summary()` is a function that returns various statistical measurements for each variable.

The ISO 8601 standard is the convention for date-time formatting. Dates are represented in the format YYYY-MM-DD, as seen in the `date` observations in the `globe_temps` dataset.

### Exercise 2

Within `ggplot()` set `data` to `globe_temps`.

```{r geomline-wiith-tempe-2, exercise = TRUE}

```

```{r geomline-wiith-tempe-2-hint-1, eval = FALSE}
ggplot(data = ...)
```

### 

Setting the `data` argument binds the `ggplot` object to the specified dataset.

### Exercise 3

Within `ggplot()`, now set the argument `mapping` to equal `aes()`. Within `aes()`, map `date` to the x-axis and `temperature` to the y-axis.

```{r geomline-wiith-tempe-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomline-wiith-tempe-3-hint-1, eval = FALSE}
ggplot(data = `globe_temps`, 
       aes(x = ..., y = ...))
```

### 

Because time is an inherently sequential value, it will often be the independent variable in line graphs.

### Exercise 4

Now add a call to the `geom_line()` function.

```{r geomline-wiith-tempe-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomline-wiith-tempe-4-hint-1, eval = FALSE}
ggplot(data = `globe_temps`, 
       aes(x = date, y = temperature)) + 
  ...
```

### 

Congratulations on your first line plot! This graph could stand on its own, but a trend line could be helpful to us here.

### Exercise 5

Now add a call to the `geom_smooth()` function. 

```{r geomline-wiith-tempe-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomline-wiith-tempe-5-hint-1, eval = FALSE}
ggplot(data = `globe_temps`, 
       aes(x = date, y = temperature)) + 
  geom_line() +
  ...
```

### 

Like in the previous section, notice the warning message in the R Console window because we didn't specify certain parameters.

### Exercise 6

Set the `method` parameter to `"loess"`, `formula` to `y ~ x`, and `se` to `FALSE`.

```{r geomline-wiith-tempe-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r geomline-wiith-tempe-6-hint-1, eval = FALSE}
ggplot(data = `globe_temps`, 
       aes(x = date, y = temperature)) + 
  geom_line() +
  geom_smooth(method = "loess", 
              formula = y ~ x, 
              se = FALSE)
```

### 

For relatively smaller datasets, `method` by default, is set to `"loess"`. For datasets larger than 1,000 observations, `method` is set to another technique, `"gam"`. 

### Exercise 7

Now use `labs()` to set an appropriate title, subtitle, axes labels, and caption for the graph.

```{r geomline-wiith-tempe-7, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomline-wiith-tempe-7-hint-1, eval = FALSE}
... +
  labs(title = "...",
       subtitle = "..."
       x = "...",
       y = "...",
       caption = "...")
```

Reminder: This is what our graph should look like.

```{r show-line-p}
globe_temps_p
```

### 

Nice job! This is the most fundamental line graph, `geom_line()` has many additional arguments (e.g. `linetype` or `color`). Connected observations can also be visualized using `geom_step()`, `geom_path()`, `geom_line()`, `geom_ribbon`.

## geom_histogram with BMI
### 

A histogram is a plot that visualizes the distribution of a numerical variable with bars.

### 

Let's create the following histogram via the `usbmi` dataset.

```{r make-hist-p}
hist_p <- ggplot(data = usbmi, aes(x = bmi)) +
    geom_histogram(binwidth = 1,
                   color = "white") +
    labs(title = "BMI of Americans",
         subtitle = "Significant number of Americans are overweight or obese",
         x = "Body Mass Index",
         y = "Count")
hist_p
```

### Exercise 1

As always, let's first explore the data. Run `summary(usbmi)`.

```{r geomhistogram-with-b-1, exercise = TRUE}

```

### 

If the mean, median and the mode of a set of numbers are equal, it means, the distribution is symmetric. Otherwise, it is characterized as asymmetric.

<!-- VD: This should be elaborated upon a bit -->

### Exercise 2

Within `ggplot()`, set `data` to `usbmi`.

```{r geomhistogram-with-b-2, exercise = TRUE}

```

```{r geomhistogram-with-b-2-hint-1, eval = FALSE}
ggplot(data = ...)
```

### 

The `data` argument for `ggplot()` requires the object to be of type `data.fram`. If not, as with `usbmi`, the dataset will be converted to one by `fortify()`.

### Exercise 3

Now, map `bmi` to the x-axis since we want to see the distribution of BMI scores.

```{r geomhistogram-with-b-3, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomhistogram-with-b-3-hint-1, eval = FALSE}
ggplot(data = ..., 
       mapping = aes(x = ...))
```

### Exercise 4

Let's now add the layer `geom_histogram()`.

```{r geomhistogram-with-b-4, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomhistogram-with-b-4-hint-1, eval = FALSE}
Remember when you add a layer you use +. 
```

```{r geomhistogram-with-b-4-hint-2, eval = FALSE}
ggplot(data = ..., 
       mapping = aes(x = ...)) +
  geom_histogram()
```

### 

`geom_histogram()` has a default y-axis which is the **count** for the number of observations that fall into a particular bin of the x-axis variable.

### Exercise 5

Specify the width of bins to be 1 using the `binwidth` argument in `geom_histogram()`.

```{r geomhistogram-with-b-5, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomhistogram-with-b-5-hint-1, eval = FALSE}
ggplot(data = usbmi, 
       mapping = aes(x = bmi)) +
  geom_histogram(binwidth = ...)
```

### 

Another way to set the number of bins is to specify the `bins` argument to this desired numerical value.

### Exercise 6

Add white vertical borders demarcating the bins by setting the argument `color` to `"white"` within `geom_histogram()`.

```{r geomhistogram-with-b-6, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomhistogram-with-b-6-hint-1, eval = FALSE}
ggplot(data = usbmi, 
       mapping = aes(x = bmi)) +
  geom_histogram(binwidth = 1,
                 color = ...)
```

### 

For plots that are not points or lines, the argument `color` only changes the outline. 

### Exercise 7

Now use `labs()` to set an appropriate title, subtitle, axes labels, and caption for the graph.

```{r geomhistogram-with-b-7, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomhistogram-with-b-7-hint-1, eval = FALSE}
... +
  labs(title = "...",
       subtitle = "..."
       x = "...",
       y = "...",
       caption = "...")
```

Reminder: This is what our graph should look like.

```{r show-hist-p}
hist_p
```

### 

Histograms display the counts with bars. To display counts with lines, you would use `geom_freqpoly()`. 

## geom_density with CCES
### 

`geom_density()` is used to make a density plot, a smoothed version of a histogram. 

### 

Let's create the following density plot using the `cces` dataset.

```{r make-dens-p}
dens_p <- ggplot(data = cces, 
                 mapping = aes(x = age, 
                               color = ideology, 
                               fill = ideology)) +
  geom_density(alpha = .1) +
  labs(title = " Distribution of Age by Ideology", 
       subtitle = "Most young people are not sure of their ideology",
       x = "Age", 
       y = "Density",
       caption = "Kuriwaki (2020)")

dens_p
```

### Exercise 1

Let's first explore the data. Run `str(cces)`. Given the plot above, can you find the two variables that would help us to identifying the age and ideology of a respondent?

```{r geomdensity-with-cce-1, exercise = TRUE}

```

### Exercise 2

Use the `cces` data set in the `primer.data` package. Within `ggplot()`, set `data` to `cces`.

```{r geomdensity-with-cce-2, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomdensity-with-cce-2-hint-1, eval = FALSE}
ggplot(data = ...)
```

### 

ggplot() initializes a ggplot object. Your output should be an empty canvas.

### Exercise 3

Let's now map the variable `age` to the `x` argument inside `aes()`.

```{r geomdensity-with-cce-3, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomdensity-with-cce-3-hint-1, eval = FALSE}
ggplot(data = cces, 
       mapping = aes(x = ...))
```

### Exercise 4

Let's now add the layer `geom_density()`

```{r geomdensity-with-cce-4, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomdensity-with-cce-4-hint-1, eval = FALSE}
ggplot(data = cces, 
       mapping = aes(x = ...)) +
  geom_density()
```

### 

This plot displays a density distribution for all ideologies by age. We will split this distribution by ideology next.

### Exercise 5

Now within `aes`, set `color` and `fill` equal to the variable `ideology`.

```{r geomdensity-with-cce-5, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomdensity-with-cce-5-hint-1, eval = FALSE}
ggplot(data = cces, 
       mapping = aes(x = ..., 
                     color = ..., 
                     fill = ...)) + 
  geom_density()
```

### 

We are getting closer! Right now, the distributions of one ideology are covering others because their `fill` is 100% opaque.

### Exercise 6

Now set the `alpha` argument in `geom_density()` to 0.1.

```{r geomdensity-with-cce-6, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomdensity-with-cce-6-hint-1, eval = FALSE}
... + 
  geom_density(alpha = 0.1)
```

### Exercise 7

Finally set an appropriate title, subtitle, axes labels, and caption for the graph.

```{r geomdensity-with-cce-7, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geomdensity-with-cce-7-hint-1, eval = FALSE}
... +
  labs(title = "...",
       subtitle = "..."
       x = "...",
       y = "...",
       caption = "...")
```

Reminder: Your graph should look something like this.

```{r show-dens-p}
dens_p
```

### 

Good work! Similar plots that you could look into include `geom_freqpoly()` and `geom_violin()`.

## geom_bar with immigration attitudes
### 

A barplot is a plot that visualizes the distribution of a categorical variable.

### 

Let's create the following barplot using the `trains` dataset.

```{r make-bar-p}
bar_p <- ggplot(data = trains, 
       mapping = aes(x = treatment, 
                     fill = party)) +
  geom_bar(position = "dodge") +
  labs(title = "Democrats and Republicans in Treated and Control Groups",
       subtitle = "Few Republicans in both treated and control groups", 
       x = "Treatment", 
       y = "Count",
       caption = "Enos(2014)")

bar_p
```

### Exercise 1

Let's first explore the data. Run `str(trains)`. 

```{r geombar-with-immigra-1, exercise = TRUE}

```

### Exercise 2

Use the `trains` data set in the `primer.data` package. Within `ggplot()`, set `data` to `trains`.

```{r geombar-with-immigra-2, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geombar-with-immigra-2-hint-1, eval = FALSE}
ggplot(data = ...)
```

### 

ggplot() initializes a ggplot object. Your output should be an empty canvas.

### Exercise 3

Let's now map the variable `treatment` to the `x`argument inside `aes()`.

```{r geombar-with-immigra-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">

```{r geombar-with-immigra-3-hint-1, eval = FALSE}
ggplot(data = trains, 
       mapping = aes(x = ...))
```

### Exercise 4

Let's now add the layer `geom_bar()`

```{r geombar-with-immigra-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">

```{r geombar-with-immigra-4-hint-1, eval = FALSE}
ggplot(data = trains, 
       mapping = aes(x = ...)) +
  geom_bar()
```

### 

This plot breaks down the count of the study by treatment group, does not split these groups by party. We will do this next.

### Exercise 5

Let's now also map the variable `party` to the `fill` argument.

```{r geombar-with-immigra-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">

```{r geombar-with-immigra-5-hint-1, eval = FALSE}
ggplot(data = trains, 
       mapping = aes(x = treatment, 
                     fill = ...)) +
  geom_bar()
```

### 

We use the `fill` argument instead of the `color` argument because we want to color the interior of the shape but not its borders.

Now, we can see the composition of each treatment group by party. Notice that the party bars are stacked.

### Exercise 6

Let's make our graph a side-by-side barplot. Set `position` to `"dodge"` in `geom_bar()`.

```{r geombar-with-immigra-6, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geombar-with-immigra-6-hint-1, eval = FALSE}
ggplot(data = trains, 
       mapping = aes(x = treatment, 
                     fill = party)) +
  geom_bar(position = ...)
```

### 

By default `position` is set to `"stack"`. `"dodge"` puts different colors side by side.

### Exercise 7

Now use `labs()` to set an appropriate title, subtitle, axes labels, and caption for the graph.

```{r geombar-with-immigra-7, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r geombar-with-immigra-7-hint-1, eval = FALSE}
... +
  labs(title = "...",
       subtitle = "..."
       x = "...",
       y = "...",
       caption = "...")
```

Reminder: This is what our graph should look like.

```{r show-bar-p}
bar_p
```

### 

Good work! You created your first graph using `geom_bar()`. `geom_col()` is a similar function where instead, the dataset specifies the height of each bar.


## Summary
### 

This tutorial covered [Chapter 2: Data Visualization](https://r4ds.hadley.nz/data-visualize.html) from [*R for Data Science (2e)*](https://r4ds.hadley.nz/) by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund. 


```{r download-answers, child = system.file("child_documents/download_answers.Rmd", package = "tutorial.helpers")}
```
